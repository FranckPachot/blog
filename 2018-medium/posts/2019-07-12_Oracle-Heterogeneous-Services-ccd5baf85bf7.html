<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Oracle Heterogeneous Services</title><style>
      * {
        <!--font-family: Georgia, Cambria, "Times New Roman", Times, serif;-->
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Oracle Heterogeneous Services</h1>
</header>
<section data-field="subtitle" class="p-summary">
An example configuring Oracle ODBC gateway to PostgreSQL
</section>
<section data-field="body" class="e-content">
<section name="da6c" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7df7" id="7df7" class="graf graf--h3 graf--leading graf--title">Oracle Heterogeneous Services</h3><h4 name="f5a4" id="f5a4" class="graf graf--h4 graf-after--h3 graf--subtitle">An example configuring Oracle ODBC gateway to PostgreSQL</h4><p name="a3aa" id="a3aa" class="graf graf--p graf-after--h4">That sounds futuristic, like a 2025 post-microservices trend. Monolithic databases are definitely dismantled, we developed in microservices, spread data to many databases. Because we had agile development teams, they have chosen the database technology that fits their need: cheap, easy, free from any infrastructure constraints, and of course cool enough for their CV. The enterprise information system is now a zoo with all species represented.</p><figure name="e7e6" id="e7e6" class="graf graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 996px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 189.7%;"></div><img class="graf-image" data-image-id="1*5NqQwPkEzo5v78Y328IvWw.png" data-width="699" data-height="1326" src="https://cdn-images-1.medium.com/max/600/1*5NqQwPkEzo5v78Y328IvWw.png"></div><figcaption class="imageCaption"><a href="https://web.archive.org/web/19961219141518/http://www.oracle.com/products/gateways/html/transparent.html" data-href="https://web.archive.org/web/19961219141518/http://www.oracle.com/products/gateways/html/transparent.html" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">https://web.archive.org/web/19961219141518/http://www.oracle.com/products/gateways/html/transparent.html</a></figcaption></figure><p name="c397" id="c397" class="graf graf--p graf-after--figure">Then, the business needs to query and operate on data that has been produced in many different sources, heterogeneous systems, and polyglot data structures. Of course, all was sourced, streamed and replicated, with an approximate consistency and latency.</p><p name="c29e" id="c29e" class="graf graf--p graf-after--p">But after all that fun, the data analysts need a consistent and integrated view of this data to meet their business objectives. They need to process it in one system only. They need to map it and query transparently, without having to learn different languages and structures. They may even want to enrich it, updating the multiple systems, in a transaction that stays consistent even in case of failure.</p><p name="0dd4" id="0dd4" class="graf graf--p graf-after--p">Actually, this is not new. The screenshot above is from 1995 when Oracle introduced their Oracle Gateway to connect to other databases like if they were Oracle ones. We can run DML, procedures, and transactions over Database Links. It has evolved with gateways to specific database systems, but the gateway to ODBC databases is still there and free. And Heterogenous Services are available even in Standard Edition.</p><p name="5567" id="5567" class="graf graf--p graf-after--p">Today, whether you want to offload some tables to a different DB, or you already have multiple DBMS that you want to query from a single service, you will have to run queries and transactions across different systems. Here is an example where I’ll connect Oracle DB Links to a PostgreSQL database.</p><figure name="2828" id="2828" class="graf graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 259px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 49.2%;"></div><img class="graf-image" data-image-id="1*dwOFOlAj22tB2SPc1Wx1eA.png" data-width="1657" data-height="816" data-is-featured="true" src="https://cdn-images-1.medium.com/max/600/1*dwOFOlAj22tB2SPc1Wx1eA.png"></div></figure><p name="8c8c" id="8c8c" class="graf graf--p graf-after--figure">In this example, I prefix the name with the type, like: <em class="markup--em markup--p-em">usr</em>demo for the user, <em class="markup--em markup--p-em">dsn</em>demo for the data source name, <em class="markup--em markup--p-em">lsn</em>demo for the listener… That’s not something I do usually but it helps to understand clearly the link of components. There is a double network communication for each call here: from the database Heterogenous Service to the Gateway listener, and the listener calls the remote database through ODBC.</p><figure name="1ab8" id="1ab8" class="graf graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 396px; max-height: 642px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 162.1%;"></div><img class="graf-image" data-image-id="1*AqHwMZUZvw7RVc1SoxaJOg.png" data-width="396" data-height="642" src="https://cdn-images-1.medium.com/max/600/1*AqHwMZUZvw7RVc1SoxaJOg.png"></div></figure><h3 name="29b0" id="29b0" class="graf graf--h3 graf-after--figure">1. Install a PostgreSQL database</h3><p name="0d5a" id="0d5a" class="graf graf--p graf-after--h3">For this demo, I have setup an Oracle DBaaS in the Oracle Cloud Infrastructure which is a PaaS (the database is installed automatically and ready to use) but with IaaS access (I can connect as root and install whatever I need).</p><p name="8cc4" id="8cc4" class="graf graf--p graf-after--p">I chose a 19c Standard Edition (19c has just been made available this week on this service) running on Oracle Linux 7.5 which is the same as RHEL7.</p><p name="590b" id="590b" class="graf graf--p graf-after--p">There, I have an Oracle Database 19c already running on Oracle Enterprise Linux 7 and I install PostgreSQL 11 to demo the gateway.</p><pre name="8820" id="8820" class="graf graf--pre graf-after--p">sudo rpm -Uvh <a href="https://yum.postgresql.org/11/redhat/rhel-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm" data-href="https://yum.postgresql.org/11/redhat/rhel-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm" class="markup--anchor markup--pre-anchor" rel="nofollow noopener noopener" target="_blank">https://yum.postgresql.org/11/redhat/rhel-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm</a><br>sudo yum install -y postgresql11-server</pre><p name="8ef0" id="8ef0" class="graf graf--p graf-after--pre">I create a database and initialize it with pgbench.</p><pre name="0078" id="0078" class="graf graf--pre graf-after--p">sudo mkdir -p /u01/pgdata &amp;&amp; sudo chown -R postgres /u01/pgdata<br>sudo su postgres<br> export PGDATA=/u01/pgdata<br> # create the database<br> /usr/pgsql-11/bin/initdb -D $PGDATA<br> # I prefer password authentication:<br> sed -i &#39;/^host *all/s/trust/md5/&#39; /u01/pgdata/pg_hba.conf<br> # start the server<br> /usr/pgsql-11/bin/pg_ctl -D $PGDATA -l /u01/pgdata/logfile start<br> # create user and database<br> /usr/pgsql-11/bin/psql <br>  create user usrdemo password &#39;pwddemo&#39;;<br>  create database demo;<br>  \q<br> whoami | grep postgres &amp;&amp; exit<br>sudo su - oracle</pre><pre name="22f5" id="22f5" class="graf graf--pre graf-after--pre">PGPASSWORD=pwddemo /usr/pgsql-11/bin/pgbench -i -h localhost -p 5432 -U usrdemo demo</pre><p name="d830" id="d830" class="graf graf--p graf-after--pre">Now I have a ‘demo’ database with pgbench tables, accessible from my oracle user through TCP/IP port 5432 with user ‘usrdemo’ password ‘pwddemo’</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="88a9" id="88a9" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1032px; max-height: 440px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 42.699999999999996%;"></div><img class="graf-image" data-image-id="1*Nt9SKdBCru89E50Jwac1LA.png" data-width="1678" data-height="716" src="https://cdn-images-1.medium.com/max/1200/1*Nt9SKdBCru89E50Jwac1LA.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="5fe4" id="5fe4" class="graf graf--h3 graf-after--figure">2. Install Linux ODBC and Postgres ODBC</h3><p name="ff63" id="ff63" class="graf graf--p graf-after--h3">The free Oracle Gateway connects to any database through ODBC. I install the ODBC driver for PostgreSQL</p><pre name="54d5" id="54d5" class="graf graf--pre graf-after--p">sudo yum install -y postgresql11-odbc<br>ls /usr/pgsql-11/lib/psqlodbc.so</pre><p name="58f8" id="58f8" class="graf graf--p graf-after--pre">I define my PostgreSQL database as the ODBC Data Source:</p><pre name="7f90" id="7f90" class="graf graf--pre graf-after--p">cat &gt; /home/oracle/odbcDG4PGDEMO.ini &lt;&lt;END<br>[<strong class="markup--strong markup--pre-strong">DSNPGDEMO</strong>]<br>Database         = <strong class="markup--strong markup--pre-strong">demo</strong><br>Description      = Connection to PostgreSQL<br>Driver           = PostgreSQL<br>Servername       = <strong class="markup--strong markup--pre-strong">localhost</strong><br>Port             = <strong class="markup--strong markup--pre-strong">5432</strong><br>Username         = <strong class="markup--strong markup--pre-strong">usrdemo<br></strong>END</pre><p name="da07" id="da07" class="graf graf--p graf-after--pre">You can use the default location like /etc/odbc.ini or $HOME/.odbc.ini but here I show a specific location just to mention it.</p><h3 name="c900" id="c900" class="graf graf--h3 graf-after--p">3. Install Oracle Gateway</h3><p name="327c" id="327c" class="graf graf--p graf-after--h3">I download the Heterogeneous Services Database Gateways to non-Oracle Databases. On the Oracle Database Software Downloads, choose the “See All” link:</p><div name="1f90" id="1f90" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://www.oracle.com/technetwork/database/enterprise-edition/downloads/oracle19c-linux-5462157.html" data-href="https://www.oracle.com/technetwork/database/enterprise-edition/downloads/oracle19c-linux-5462157.html" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://www.oracle.com/technetwork/database/enterprise-edition/downloads/oracle19c-linux-5462157.html"><strong class="markup--strong markup--mixtapeEmbed-strong"><em class="markup--em markup--mixtapeEmbed-em">Oracle Database 19c Download for Linux x86-64</em></strong><br>Oracle Database 19c Download for Linux x86-64www.oracle.com</a><a href="https://www.oracle.com/technetwork/database/enterprise-edition/downloads/oracle19c-linux-5462157.html" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="c52d2fe74dcad510ec20d85e5cdb908e"></a></div><p name="2c18" id="2c18" class="graf graf--p graf-after--mixtapeEmbed">From there I download the <a href="https://download.oracle.com/otn/linux/oracle19c/190000/LINUX.X64_193000_gateways.zip" data-href="https://download.oracle.com/otn/linux/oracle19c/190000/LINUX.X64_193000_gateways.zip" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">LINUX.X64_193000_gateways.zip</strong></a> (that must be done manually, clicking the “I accept the license terms” checkbox).</p><p name="0c6b" id="0c6b" class="graf graf--p graf-after--p">I install it in my Oracle Home (ORACLE_HOME must be set):</p><pre name="c5be" id="c5be" class="graf graf--pre graf-after--p">unzip LINUX.X64_193000_gateways.zip<br>cd gateways<br>./runInstaller -silent<br>sudo $ORACLE_HOME/root.sh</pre><p name="5189" id="5189" class="graf graf--p graf-after--pre">I have now some additional binaries and an HS (Heterogeneous Services) product directory:</p><figure name="8b14" id="8b14" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 684px; max-height: 364px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53.2%;"></div><img class="graf-image" data-image-id="1*m1c1tWLGyWoOgJfHu0XUZA.png" data-width="684" data-height="364" src="https://cdn-images-1.medium.com/max/800/1*m1c1tWLGyWoOgJfHu0XUZA.png"></div><figcaption class="imageCaption">tree $ORACLE_HOME/hs</figcaption></figure><h3 name="db68" id="db68" class="graf graf--h3 graf-after--figure">4. Setup Oracle Gateway to ODBC</h3><p name="b3c5" id="b3c5" class="graf graf--p graf-after--h3">In this directory I define the Gateway configuration which references the ODBC driver and DSN:</p><pre name="1ef0" id="1ef0" class="graf graf--pre graf-after--p">cat &gt; $ORACLE_HOME/hs/admin/init<strong class="markup--strong markup--pre-strong">DG4PGDEMO</strong>.ora &lt;&lt;END<br>set ODBCINI=/home/oracle<strong class="markup--strong markup--pre-strong">/odbcDG4PGDEMO.ini<br></strong>HS_FDS_CONNECT_INFO = <strong class="markup--strong markup--pre-strong">DSNPGDEMO</strong><br>HS_FDS_SHAREABLE_NAME=/usr/pgsql-11/lib/psqlodbc.so<br>HS_LANGUAGE=AMERICAN_AMERICA.WE8ISO8859P1<br>#HS_FDS_TRACE_LEVEL=ON<br>END</pre><p name="3b80" id="3b80" class="graf graf--p graf-after--pre">The “set ODBCINI” must be used if we don’t use the default /etc/odbc.init or $HOME/.odbc.ini</p><p name="514c" id="514c" class="graf graf--p graf-after--p">The trace can dump more information to the log subdirectory in case of an error is encountered.</p><p name="2fad" id="2fad" class="graf graf--p graf-after--p">This Database Gateway has a System IDentifier, that will be referenced by the listener. The exposed database name is HO.WORLD by default, which is very ugly, but you can change that with HS_DB_NAME and HS_DB_DOMAIN.</p><h3 name="422d" id="422d" class="graf graf--h3 graf-after--p">5. Setup Oracle Gateway listener</h3><p name="4572" id="4572" class="graf graf--p graf-after--h3">The name is referenced with SID_NAME from a listener:</p><pre name="ca71" id="ca71" class="graf graf--pre graf-after--p">cat &gt;&gt; $ORACLE_HOME/network/admin/listener.ora &lt;&lt;END<br><strong class="markup--strong markup--pre-strong">LSNPGDEMO</strong>=(DESCRIPTION_LIST=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=0.0.0.0)(PORT=<strong class="markup--strong markup--pre-strong">1520</strong>))))<br>SID_LIST_<strong class="markup--strong markup--pre-strong">LSNPGDEMO</strong>=(SID_LIST=(SID_DESC=(SID_NAME=<strong class="markup--strong markup--pre-strong">DG4PGDEMO</strong>)(ORACLE_HOME=$ORACLE_HOME)(PROGRAM=<strong class="markup--strong markup--pre-strong">dg4odbc</strong>))))<br>END</pre><p name="f627" id="f627" class="graf graf--p graf-after--pre">I start this listener:</p><pre name="1812" id="1812" class="graf graf--pre graf-after--p">lsnrctl &lt;&lt;END<br> set current_listener <strong class="markup--strong markup--pre-strong">LSNPGDEMO</strong><br> start<br> set displaymode raw<br> services<br>END</pre><p name="377f" id="377f" class="graf graf--p graf-after--pre">The listener is the Gateway that will be contacted by the Heterogenous Services.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="17a7" id="17a7" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1032px; max-height: 353px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 34.2%;"></div><img class="graf-image" data-image-id="1*SSEa1NajwNV9sKxiFhFYOA.png" data-width="2702" data-height="925" src="https://cdn-images-1.medium.com/max/1200/1*SSEa1NajwNV9sKxiFhFYOA.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="98a6" id="98a6" class="graf graf--h3 graf-after--figure">6. Setup Heterogenous Services</h3><p name="0fc1" id="0fc1" class="graf graf--p graf-after--h3">I define a tnsnames.ora entry to connection to this listener:</p><pre name="f936" id="f936" class="graf graf--pre graf-after--p">cat &gt;&gt; $ORACLE_HOME/network/admin/tnsnames.ora &lt;&lt;END<br>TNSPGDEMO=(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=localhost)(PORT=1520))(CONNECT_DATA=(SID=DG4PGDEMO))(HS=OK))<br>END</pre><p name="25af" id="25af" class="graf graf--p graf-after--pre">I can tnsping but not connect because this is an Heterogenous Service agent</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="d042" id="d042" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1032px; max-height: 332px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 32.2%;"></div><img class="graf-image" data-image-id="1*gL0PYuMUeXZXrJJZ1D_gMw.png" data-width="2151" data-height="692" src="https://cdn-images-1.medium.com/max/1200/1*gL0PYuMUeXZXrJJZ1D_gMw.png"></div><figcaption class="imageCaption">ORA-28547: connection to server failed, probable Oracle Net admin error</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="e3b5" id="e3b5" class="graf graf--h3 graf-after--figure">7. Create Heterogenous Services database link</h3><p name="424e" id="424e" class="graf graf--p graf-after--h3">All components are there and ready for heterogeneous queries and transactions. I have a pluggable database PDB1 and create a demo user there.</p><pre name="ae4a" id="ae4a" class="graf graf--pre graf-after--p">echo -e &#39;alter session set container=PDB1;\ngrant dba to demo identified by &quot;Ora4c!eC!0ud&quot; container=current;&#39; | sqlplus / as sysdba</pre><p name="7e57" id="7e57" class="graf graf--p graf-after--pre">Note that I’ll set global_names to false here because I’ve not defined a name and domain for my gateway. Then it is called HO.WORLD and I don’t want to have my database link names starting with “HO.WORLD”. And if I don’t, with the default global_names, I’ll get something like: “ORA-02085: database link DBLPGDEMO.SUB11131414120.ACEDVCN.ORACLEVCN.COM”. To avoid this, either I set HS_DB_NAME and HS_DB_DOMAIN or I forget about global name enforcement.</p><h4 name="0ae4" id="0ae4" class="graf graf--h4 graf-after--p">7a. dictionary translation</h4><pre name="5180" id="5180" class="graf graf--pre graf-after--h4">sqlplus demo/&#39;Ora4c!eC!0ud&#39;@//localhost:1521/PDB1<br> alter system set global_names=false;<br> drop database link DBLPGDEMO;<br> create database link DBLPGDEMO connect to &quot;usrdemo&quot; identified by  &quot;pwddemo&quot; using &#39;TNSPGDEMO&#39;;<br> desc &quot;pgbench_accounts&quot;@DBLPGDEMO</pre></div><div class="section-inner sectionLayout--outsetColumn"><figure name="8abf" id="8abf" class="graf graf--figure graf--layoutOutsetCenter graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1032px; max-height: 466px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 45.1%;"></div><img class="graf-image" data-image-id="1*4wMuCw02RTxEnA9LggMEAw.png" data-width="1647" data-height="743" src="https://cdn-images-1.medium.com/max/1200/1*4wMuCw02RTxEnA9LggMEAw.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="af6a" id="af6a" class="graf graf--p graf-after--figure">That’s the first gem from Oracle transparent gateway: you see the metadata as if it were an Oracle database. The PostgreSQL tables, columns and datatypes were converted to Oracle ones.</p><h4 name="a72d" id="a72d" class="graf graf--h4 graf-after--p">7b. distributed queries</h4><p name="0ab7" id="0ab7" class="graf graf--p graf-after--h4">The second gem is about the optimizer. You can run joins between two remote queries and they will be processed on the right site:</p><pre name="7dd2" id="7dd2" class="graf graf--pre graf-after--p">explain plan for<br>select count(*) from &quot;pgbench_branches&quot;@DBLPGDEMO <br> join &quot;pgbench_accounts&quot;@DBLPGDEMO using (&quot;bid&quot;)<br> where &quot;abalance&quot;=0;<br>set pagesize 5000 linesize 150<br>select * from dbms_xplan.display();</pre></div><div class="section-inner sectionLayout--outsetColumn"><figure name="df8c" id="df8c" class="graf graf--figure graf--layoutOutsetCenter graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1032px; max-height: 512px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 49.6%;"></div><img class="graf-image" data-image-id="1*6zmGmbPyQ-TfMZnOFB9y7Q.png" data-width="1704" data-height="846" src="https://cdn-images-1.medium.com/max/1200/1*6zmGmbPyQ-TfMZnOFB9y7Q.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="4ff7" id="4ff7" class="graf graf--p graf-after--figure">Cardinality estimation is not as accurate as for local tables, but the query that is pushed will be optimized by the remote optimizer.</p><h4 name="131c" id="131c" class="graf graf--h4 graf-after--p">7c. native passthrough</h4><p name="7bfa" id="7bfa" class="graf graf--p graf-after--h4">The third gem is the possibility to run any native query with the DBMS_HS_PASSTHROUGH which is very similar to DBMS_SQL:</p><pre name="f5f6" id="f5f6" class="graf graf--pre graf-after--p">set serveroutput on<br>declare<br>   val number;<br>   c number;<br>   n number;<br>begin<br>  c:=dbms_hs_passthrough.open_cursor@DBLPGDEMO;<br>  dbms_hs_passthrough.parse@DBLPGDEMO(c,q&#39;[<br>    select count(*) from &quot;pgbench_branches&quot;<br>    join &quot;pgbench_accounts&quot; using (&quot;bid&quot;)<br>    where &quot;abalance&quot;=0;<br>  ]&#39;);<br>  loop<br>    n := dbms_hs_passthrough.fetch_row@DBLPGDEMO(c);<br>    exit when n = 0;<br>    dbms_hs_passthrough.get_value@DBLPGDEMO(c,1,val);<br>    dbms_output.put_line(val);<br>  end loop;<br>  dbms_hs_passthrough.close_cursor@DBLPGDEMO(c);<br>end;<br>/</pre></div><div class="section-inner sectionLayout--outsetColumn"><figure name="de60" id="de60" class="graf graf--figure graf--layoutOutsetCenter graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1032px; max-height: 551px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53.400000000000006%;"></div><img class="graf-image" data-image-id="1*UI2GXIazC2umUHWFFYcRPA.png" data-width="1362" data-height="727" src="https://cdn-images-1.medium.com/max/1200/1*UI2GXIazC2umUHWFFYcRPA.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="a169" id="a169" class="graf graf--p graf-after--figure">You wonder how this DBMS_HS_PASSTHROUGH is called with a database link as of it was on the remote database, but you know that it is not defined there? It is actually interpreted by the Gateway, more info about this magic:</p><div name="5349" id="5349" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://connor-mcdonald.com/2012/07/18/dbms_hs_passthroughthe-magic-package/" data-href="https://connor-mcdonald.com/2012/07/18/dbms_hs_passthroughthe-magic-package/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://connor-mcdonald.com/2012/07/18/dbms_hs_passthroughthe-magic-package/"><strong class="markup--strong markup--mixtapeEmbed-strong">dbms_hs_passthrough-the magic package</strong><br><em class="markup--em markup--mixtapeEmbed-em">This is a package that you can call, that does not exist in the database. I found this out after reading about its…</em>connor-mcdonald.com</a><a href="https://connor-mcdonald.com/2012/07/18/dbms_hs_passthroughthe-magic-package/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="b42bc051ee5c31b6bf5c3bd699b183cd" data-thumbnail-img-id="0*BmtKQmkiNASHbHqD" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*BmtKQmkiNASHbHqD);"></a></div><h3 name="1cb1" id="1cb1" class="graf graf--h3 graf-after--mixtapeEmbed">8. Troubleshoot</h3><p name="f2cf" id="f2cf" class="graf graf--p graf-after--h3">There are limitation, some cryptic error messages but enabling the trace with HS_FDS_TRACE_LEVEL=ON creates a file in ?/hs/log/&lt;pid&gt;.trc</p><pre name="b24d" id="b24d" class="graf graf--pre graf-after--p">Oracle Corporation --- 2019-07-09 21:39:02.167558000</pre><pre name="d39f" id="d39f" class="graf graf--pre graf-after--pre">Heterogeneous Agent Release<br>19.0.0.0.0</pre><pre name="1acd" id="1acd" class="graf graf--pre graf-after--pre">Oracle Corporation --- 2019-07-09 21:39:02.167304000</pre><pre name="b234" id="b234" class="graf graf--pre graf-after--pre">Version 19.0.0.0.0</pre><pre name="91a1" id="91a1" class="graf graf--pre graf-after--pre">HOSGIP for &quot;HS_FDS_TRACE_LEVEL&quot; returned &quot;ON&quot;<br>HOCXU_VC2_MAX=4000<br>HOCXU_RAW_MAX=2000<br>HOSGIP for &quot;HS_FDS_SHAREABLE_NAME&quot; returned &quot;/usr/pgsql-11/lib/psqlodbc.so&quot;<br>HOSGIP for &quot;HS_OPEN_CURSORS&quot; returned &quot;50&quot;<br>HOSGIP for &quot;HS_FDS_FETCH_ROWS&quot; returned &quot;100&quot;<br>HOSGIP for &quot;HS_LONG_PIECE_TRANSFER_SIZE&quot; returned &quot;65536&quot;<br>HOSGIP for &quot;HS_NLS_NUMERIC_CHARACTERS&quot; returned &quot;.,&quot;<br>HOSGIP for &quot;HS_KEEP_REMOTE_COLUMN_SIZE&quot; returned &quot;OFF&quot;<br>HOSGIP for &quot;HS_FDS_DELAYED_OPEN&quot; returned &quot;TRUE&quot;<br>HOSGIP for &quot;HS_FDS_WORKAROUNDS&quot; returned &quot;0&quot;<br>HOSGIP for &quot;HS_FDS_MBCS_TO_GRAPHIC&quot; returned &quot;FALSE&quot;<br>HOSGIP for &quot;HS_FDS_GRAPHIC_TO_MBCS&quot; returned &quot;FALSE&quot;<br>HOSGIP for &quot;HS_FDS_RECOVERY_ACCOUNT&quot; returned &quot;RECOVER&quot;<br>HOSGIP for &quot;HS_FDS_TRANSACTION_LOG&quot; returned &quot;HS_TRANSACTION_LOG&quot;<br>HOSGIP for &quot;HS_FDS_TIMESTAMP_MAPPING&quot; returned &quot;DATE&quot;<br>HOSGIP for &quot;HS_FDS_DATE_MAPPING&quot; returned &quot;DATE&quot;<br>HOSGIP for &quot;HS_FDS_TRUNC_ANSI_DATE&quot; returned &quot;OFF&quot;<br>HOSGIP for &quot;HS_FDS_MAP_NCHAR&quot; returned &quot;TRUE&quot;<br>HOSGIP for &quot;HS_FDS_RESULTSET_SUPPORT&quot; returned &quot;FALSE&quot;<br>HOSGIP for &quot;HS_FDS_RSET_RETURN_ROWCOUNT&quot; returned &quot;FALSE&quot;<br>HOSGIP for &quot;HS_FDS_PROC_IS_FUNC&quot; returned &quot;FALSE&quot;<br>HOSGIP for &quot;HS_FDS_REPORT_REAL_AS_DOUBLE&quot; returned &quot;FALSE&quot;<br> using postgres as default schema<br>HOSGIP for &quot;HS_SQL_HANDLE_STMT_REUSE&quot; returned &quot;FALSE&quot;<br> HOSGIP returned value of &quot;TRUE&quot; for HS_FDS_QUOTE_IDENTIFIER<br>SQL text from hgodtab, id=0, len=44 ...<br>     00: 73656C65 6374202A 2066726F 6D202270  [select * from &quot;p]<br>     10: 6762656E 63685F61 63636F75 6E747322  [gbench_accounts&quot;]<br>     20: 20776865 72652031 203D2030           [ where 1 = 0]<br>SQL text from hgopars, id=1, len=42 ...<br>     00: 53454C45 43542043 4F554E54 282A2920  [SELECT COUNT(*) ]<br>     10: 46524F4D 20227067 62656E63 685F6163  [FROM &quot;pgbench_ac]<br>     20: 636F756E 74732220 4131               [counts&quot; A1]<br> Deferred open until first fetch.<br> Performing delayed open.<br>HOA 07/09 21:39:02.235762000: (horcrces_CleanupExtprocSession) Entered!<br>HOA 07/09 21:39:02.235786000: (horcrpooe_PopOciEnv) Entered!<br>HOA 07/09 21:39:02.235797000: (horcrfoe_FreeOciEnv) Entered!<br>HOA 07/09 21:39:02.235807000: (horcrfoe_FreeOciEnv) Exiting...<br>HOA 07/09 21:39:02.235816000: (horcrfse_FreeStackElt) Entered!<br>HOA 07/09 21:39:02.235825000: (horcrfse_FreeStackElt) Exiting...<br>HOA 07/09 21:39:02.235835000: (horcrpooe_PopOciEnv) Exiting...<br>HOA 07/09 21:39:02.235844000: (horcrces_CleanupExtprocSession) Exiting...</pre><p name="cef0" id="cef0" class="graf graf--p graf-after--pre">At least we have the default values for the non-specified parameters.</p><p name="040d" id="040d" class="graf graf--p graf-after--p graf--trailing">Finally, a little note about the architecture: the Gateway with the ODBC driver and the heterogeneous service listener can be installed on the Oracle side, the remote database side, or in the middle (why not a Docker container if it makes it more appealing?) as it communicates by TCP/IP and is not subject to licensing. Like a streaming replication server but with redundancy, no latency, and transparent real-time query.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@FranckPachot" class="p-author h-card">Franck Pachot</a> on <a href="https://medium.com/p/ccd5baf85bf7"><time class="dt-published" datetime="2019-07-12T15:58:34.463Z">July 12, 2019</time></a>.</p><p><a href="https://medium.com/@FranckPachot/oracle-heterogeneous-services-ccd5baf85bf7" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on July 27, 2019.</p></footer></article></body></html>